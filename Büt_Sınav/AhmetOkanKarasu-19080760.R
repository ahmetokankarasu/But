# -------------------------------------------------------------------------- ###
# Soru 1a ----
# -------------------------------------------------------------------------- ###
# https://github.com/ahmetokankarasu/But/

# -------------------------------------------------------------------------- ###
# Soru 2a ----
# -------------------------------------------------------------------------- ###
titanic <- read.csv("titanic.csv")
titanic <- titanic[ , c("pclass", "survived", "sex", "age", "fare")]


titanic$pclass <- as.factor(titanic$pclass)
titanic$survived <- as.factor(titanic$survived)
titanic$sex <- as.factor(titanic$sex)
summary(titanic)

library(dplyr)
titanic %>% group_by(sex)  %>% summarise(avg_fare = mean(fare, na.rm=TRUE))
#KadÄ±nlar

# -------------------------------------------------------------------------- ###
# Soru 2b ----
# -------------------------------------------------------------------------- ###
library(ggplot2)
ggplot(titanic, aes(x=age, y=sex, fill=sex)) +
  geom_boxplot()
# -------------------------------------------------------------------------- ###
# Soru 2c ----
# -------------------------------------------------------------------------- ###

titanic %>%
  ggplot(aes(x = age)) +
  geom_histogram(aes(y = ..density..),
                 colour = "black",
                 fill = "white") +
  geom_density(alpha = 0.5,
               fill = "#71f653")
# -------------------------------------------------------------------------- ###
# Soru 3a ----
# -------------------------------------------------------------------------- ###

x <- 10:20
x[seq(1, 5, by = 3)]


# -------------------------------------------------------------------------- ###
# Soru 3b ----
# -------------------------------------------------------------------------- ###

# !!!!!!!!!!!!!!!!!!!!!!!!!
# -------------------------------------------------------------------------- ###
# Soru 3c ----
# -------------------------------------------------------------------------- ###
# geom_line ve geom_point veya ggscatter

# -------------------------------------------------------------------------- ###
# Soru 3d ----
# -------------------------------------------------------------------------- ###
mylist <- list(1:3, c(3:5, NA))
myresult <- map(mylist, ~ mean(.x, na.rm = TRUE)) %>% unlist()

# !!!!!!!!!!!!!!!!!!!!!!!!!!!
# -------------------------------------------------------------------------- ###
# Soru 3e ----
# -------------------------------------------------------------------------- ###
# !!!!!!!!!!!!!!!!!!!


# -------------------------------------------------------------------------- ###
# Soru 3f ----
# -------------------------------------------------------------------------- ###
dice <- function() {
  return(sample(1:6, 2, replace = T))
}
dice()

# -------------------------------------------------------------------------- ###
# Soru 3g ----
# -------------------------------------------------------------------------- ###

t.test(age ~ survived, data = titanic, var.equal = TRUE)
# -------------------------------------------------------------------------- ###
# Soru 4a ----
# -------------------------------------------------------------------------- ###
library(tidyr)
dat2 <- pivot_longer(dat, "2018":"2020", names_to = "year", values_to = "gbp")
dat2
# -------------------------------------------------------------------------- ###
# Soru 5a ----
# -------------------------------------------------------------------------- ###
dat %>%
  ggplot() +
  aes(x = price, group = cut) +
  geom_histogram() +
  facet_wrap(~cut) +
  # labs(y = "Density", x = "Price", title = "Stata Theme") +
  # ggthemes::theme_stata() +
  theme(legend.position = "none")


